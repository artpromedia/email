# ============================================================
# OONRUMAIL - PRODUCTION ENVIRONMENT
# ============================================================
# CRITICAL: This file contains production secrets
# Store in AWS Secrets Manager, HashiCorp Vault, or similar
# NEVER commit this file to version control
# ============================================================

# ============================================================
# APPLICATION SETTINGS
# ============================================================
NODE_ENV=production
LOG_LEVEL=warn
APP_NAME=OonruMail
APP_VERSION=1.0.0

# ============================================================
# SECURITY
# ============================================================
# Generate with: openssl rand -hex 32
SESSION_SECRET=CHANGE_ME_GENERATE_RANDOM_SECRET_KEY
JWT_SECRET=CHANGE_ME_GENERATE_RANDOM_JWT_SECRET
CSRF_SECRET=CHANGE_ME_GENERATE_RANDOM_CSRF_SECRET
ENCRYPTION_KEY=CHANGE_ME_GENERATE_RANDOM_ENCRYPTION_KEY

# ============================================================
# MULTI-DOMAIN CONFIGURATION
# ============================================================
PRIMARY_DOMAIN=yourdomain.com
ALLOWED_DOMAINS=yourdomain.com,company.com
DEFAULT_DOMAIN=yourdomain.com
DOMAIN_VERIFICATION_PREFIX=_oonrumail-verify
DOMAIN_VERIFICATION_TTL=3600
MAX_DOMAINS_PER_ORG=100

# ============================================================
# DATABASE CONFIGURATION (PostgreSQL via PgBouncer)
# ============================================================
POSTGRES_HOST=pgbouncer
POSTGRES_PORT=6432
POSTGRES_USER=CHANGE_ME_DATABASE_USER
POSTGRES_PASSWORD=CHANGE_ME_STRONG_DATABASE_PASSWORD
POSTGRES_DB=enterprise_email

# Direct PostgreSQL connection (for migrations only)
POSTGRES_DIRECT_HOST=postgres-primary
POSTGRES_DIRECT_PORT=5432

# Full connection URL (via PgBouncer)
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}?sslmode=require&pool_timeout=30

# Connection pool settings
DATABASE_POOL_MIN=10
DATABASE_POOL_MAX=50
DATABASE_TIMEOUT=30000

# ============================================================
# REDIS CONFIGURATION
# ============================================================
REDIS_HOST=redis-master
REDIS_PORT=6379
REDIS_PASSWORD=CHANGE_ME_STRONG_REDIS_PASSWORD
REDIS_DB=0
REDIS_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB}
REDIS_KEY_PREFIX=email:prod:
REDIS_TLS_ENABLED=true

# Session settings
SESSION_TTL=86400
CACHE_TTL=3600

# ============================================================
# MINIO / S3 CONFIGURATION
# ============================================================
S3_ENDPOINT=https://minio.yourdomain.com
S3_REGION=us-east-1
S3_ACCESS_KEY=CHANGE_ME_MINIO_ACCESS_KEY
S3_SECRET_KEY=CHANGE_ME_MINIO_SECRET_KEY
S3_USE_SSL=true
S3_USE_PATH_STYLE=false

# Buckets
S3_ATTACHMENTS_BUCKET=prod-attachments
S3_TEMPLATES_BUCKET=prod-templates
S3_EXPORTS_BUCKET=prod-exports
S3_BACKUPS_BUCKET=prod-backups

# ============================================================
# OPENSEARCH CONFIGURATION
# ============================================================
OPENSEARCH_HOST=opensearch.yourdomain.com
OPENSEARCH_PORT=9200
OPENSEARCH_USERNAME=admin
OPENSEARCH_PASSWORD=CHANGE_ME_STRONG_OPENSEARCH_PASSWORD
OPENSEARCH_USE_SSL=true

# ============================================================
# MONITORING & OBSERVABILITY
# ============================================================
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090

GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=CHANGE_ME_STRONG_GRAFANA_PASSWORD
GRAFANA_SECRET_KEY=CHANGE_ME_GENERATE_RANDOM_GRAFANA_SECRET
GRAFANA_PORT=3000

# Sentry Error Tracking
SENTRY_DSN=https://YOUR_SENTRY_DSN@sentry.io/PROJECT_ID
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1

# ============================================================
# SMTP SERVER
# ============================================================
SMTP_HOST=0.0.0.0
SMTP_PORT=25
SMTP_SUBMISSION_PORT=587
SMTP_HOSTNAME=mail.yourdomain.com
SMTP_MAX_MESSAGE_SIZE=52428800
SMTP_MAX_RECIPIENTS=500

# TLS/SSL
SMTP_TLS_ENABLED=true
SMTP_TLS_CERT_PATH=/certs/smtp/cert.pem
SMTP_TLS_KEY_PATH=/certs/smtp/key.pem
SMTP_REQUIRE_TLS=true

# ============================================================
# IMAP SERVER
# ============================================================
IMAP_HOST=0.0.0.0
IMAP_PORT=993
IMAP_STARTTLS_PORT=143
IMAP_TLS_ENABLED=true
IMAP_TLS_CERT_PATH=/certs/imap/cert.pem
IMAP_TLS_KEY_PATH=/certs/imap/key.pem

# ============================================================
# RATE LIMITING
# ============================================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_AUTH_REQUESTS_PER_MINUTE=5
RATE_LIMIT_API_REQUESTS_PER_MINUTE=100
RATE_LIMIT_SMTP_MESSAGES_PER_HOUR=1000
RATE_LIMIT_SMTP_MESSAGES_PER_DAY=10000

# ============================================================
# DKIM CONFIGURATION
# ============================================================
DKIM_SELECTOR=mail
DKIM_KEYS_PATH=/etc/dkim/keys
DKIM_KEY_SIZE=2048
DKIM_ALGORITHM=rsa-sha256
DKIM_CANONICALIZATION=relaxed/relaxed
DKIM_KEY_ROTATION_DAYS=90

# ============================================================
# BACKUP CONFIGURATION
# ============================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=prod-backups
BACKUP_ENCRYPTION_ENABLED=true

# PostgreSQL Backup
PG_BACKUP_ENABLED=true
PG_BACKUP_KEEP_DAILY=7
PG_BACKUP_KEEP_WEEKLY=4
PG_BACKUP_KEEP_MONTHLY=12

# ============================================================
# EMAIL RETENTION
# ============================================================
EMAIL_RETENTION_ENABLED=true
EMAIL_RETENTION_DAYS=365
TRASH_AUTO_DELETE_DAYS=30
SPAM_AUTO_DELETE_DAYS=30

# ============================================================
# CORS SETTINGS
# ============================================================
CORS_ORIGIN=https://yourdomain.com,https://app.yourdomain.com
CORS_CREDENTIALS=true

# ============================================================
# NEXT.JS CONFIGURATION
# ============================================================
NEXT_PUBLIC_API_URL=https://api.yourdomain.com
NEXT_PUBLIC_WEB_URL=https://app.yourdomain.com
NEXT_PUBLIC_ADMIN_URL=https://admin.yourdomain.com
NEXT_PUBLIC_SENTRY_DSN=${SENTRY_DSN}

# ============================================================
# OAUTH/SSO CONFIGURATION
# ============================================================
OAUTH_GOOGLE_CLIENT_ID=YOUR_GOOGLE_CLIENT_ID
OAUTH_GOOGLE_CLIENT_SECRET=CHANGE_ME_GOOGLE_SECRET
OAUTH_MICROSOFT_CLIENT_ID=YOUR_MICROSOFT_CLIENT_ID
OAUTH_MICROSOFT_CLIENT_SECRET=CHANGE_ME_MICROSOFT_SECRET

# ============================================================
# FEATURE FLAGS
# ============================================================
FEATURE_MULTI_DOMAIN=true
FEATURE_SSO=true
FEATURE_TWO_FACTOR_AUTH=true
FEATURE_EMAIL_ENCRYPTION=true
FEATURE_AUDIT_LOGGING=true

# ============================================================
# ALERTING
# ============================================================
ALERT_EMAIL=alerts@yourdomain.com
PAGERDUTY_API_KEY=CHANGE_ME_PAGERDUTY_KEY
PAGERDUTY_SERVICE_ID=CHANGE_ME_SERVICE_ID

# ============================================================
# SECRETS MANAGEMENT
# ============================================================
SECRETS_PROVIDER=aws
AWS_SECRETS_MANAGER_REGION=us-east-1
AWS_SECRETS_MANAGER_PREFIX=oonrumail/prod/

# Alternative: HashiCorp Vault
# VAULT_ADDR=https://vault.yourdomain.com:8200
# VAULT_TOKEN=CHANGE_ME_VAULT_TOKEN
# VAULT_PATH=secret/oonrumail/prod
